{% extends '_base.html'%}
{% load humanize %}
{% load safe_divide %}
{% block style%}
<style>
        body {
            font-family: Arial, sans-serif;
        }
        .tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
        }

        .parent {
            height: 53px;
            width: 120px;
            position: relative;
            margin: 20px 0;
            padding: 10px;
            background-color: rgb(160, 157, 157);
            border-radius: 5px;
            text-align: center;
            margin-left: 30px;
            margin-right: 30px;
        }
        .node {
            position: relative;
            height: 53px;
            width: 120px;
            align-content: center;
            background-color: rgb(160, 157, 157);
            border-radius: 5px;
            text-align: center;
            text-overflow: clip;
            margin-left: 30px;
            margin-right: 30px;
        }

        .line {
            position: absolute;
            top: 0;
            left: 50%;
            width: 2px;
            background-color: rgb(20, 7, 7);
        }
        .line-vertical {
            height: 80px; /* Adjust to control vertical spacing */
            top: 100%;
            transform: translateX(-50%);
        }
        .line-horizontal {
            width: 5px; /* Adjust to control horizontal spacing */
            top: 50%;
        }
        .children {
            display: flex;
           
        }
</style>

{% endblock %}
{%block content %}

<div id="datatable"></div>

<script src="https://unpkg.com/sortablejs@1.7.0/Sortable.min.js"></script>
<script src="https://unpkg.com/clusterize.js@0.18.0/clusterize.min.js"></script>

<script src="https://unpkg.com/frappe-datatable@0.0.5/dist/frappe-datatable.min.js"></script>


<script>


    const user = "{{request.user}}"
    const BASE_URL = "{{BASE_URL}}"
 
    const loan_detail_url = `${BASE_URL}/api/get_loan_detail/?loan_detail=${user}`
    let _columns =  [
                    'Split', 'File Reference', 'Loan amount','Date Funded', 'GCI', 'BPS',"Branch Commission",'AHF Commission', 'Recruiter Commission']

   const columns =  _columns.map((item) => {
        return      {
            name:item,
            id: item.toLowerCase,
 
        }

    })



    axios.get(loan_detail_url)
          .then((data) => {
            const _data = data.data
            const datatable = new DataTable('#datatable',{
                columns:columns,
                data:_data,
                layout:"fixed"
               
            });
          })
          .catch((error) => {
            console.log("Error =",error);
          })

    

 
</script>

{% endblock %}